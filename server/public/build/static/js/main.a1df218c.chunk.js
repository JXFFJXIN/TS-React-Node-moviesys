(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{291:function(e,t,n){},532:function(e,t,n){"use strict";n.r(t);var a,r=n(5),o=n(0),c=n.n(o),i=n(39),s=n.n(i),u=(n(291),n(58)),p=n(43),l=n(32),d=n(33),j=n(42),b=n(41),h=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(r.jsx)("h1",{children:"\u6b22\u8fce\u4f7f\u7528\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf"})}}]),n}(c.a.Component),f=n(11),O=n.n(f),v=n(15),m=n(14),x=n(283),y=n(537),g=n(539),k=n(143),w=n(540),C=n(541),I=n(49),S=n(544),_=n(536),L=n(538),P=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showModal:!1},e}return Object(d.a)(n,[{key:"getUploadContent",value:function(){return this.props.value?null:Object(r.jsxs)("div",{children:[Object(r.jsx)(S.a,{}),Object(r.jsx)("div",{style:{color:"gray"},children:"\u7535\u5f71\u6d77\u62a5"})]})}},{key:"getFileList",value:function(){return this.props.value?[{uid:this.props.value,name:this.props.value,url:this.props.value}]:[]}},{key:"handleRequest",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append(t.filename,t.file),a=new Request(t.action,{method:"post",body:n}),e.next=5,fetch(a).then((function(e){return e.json()}));case 5:(r=e.sent).err?x.b.error(r.err):this.props.onChange&&this.props.onChange(r.data);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{children:[Object(r.jsx)(_.a,{action:"/api/upload",name:"imgfile",accept:".jpg,.png,.gif",listType:"picture-card",fileList:this.getFileList(),customRequest:this.handleRequest.bind(this),onRemove:function(){e.props.onChange&&e.props.onChange("")},onPreview:function(){e.setState({showModal:!0})},children:this.getUploadContent()}),Object(r.jsx)(L.a,{visible:this.state.showModal,title:this.props.value,footer:null,onCancel:function(){e.setState({showModal:!1})},children:Object(r.jsx)("img",{alt:"",style:{width:"100%"},src:this.props.value})})]})}}]),n}(c.a.Component),A={labelCol:{span:5},wrapperCol:{span:19}},M={wrapperCol:{offset:5,span:19}},D=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=function(){var t=Object(v.a)(O.a.mark((function t(n){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,e.props.onSubmit(n);case 3:(a=t.sent)?x.b.error(a):x.b.success("\u63d0\u4ea4\u6210\u529f",1,(function(){e.props.history.push("/movie")}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=[];if(this.props.movie){for(var a=Object.keys(this.props.movie),o=Object.values(this.props.movie),c=0;c<a.length;c++){var i={name:a[c],value:o[c]};n.push(i)}console.log(a,o,n)}return Object(r.jsxs)(y.a,Object(m.a)(Object(m.a)({onFinish:t},A),{},{style:{width:"400px",padding:"1em"},fields:n,children:[Object(r.jsx)(y.a.Item,{label:"\u7535\u5f71\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u7535\u5f71\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(r.jsx)(g.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u5c01\u9762",name:"poster",getValueFromEvent:function(e){return e},noStyle:!0,children:Object(r.jsx)(P,{})}),Object(r.jsx)(y.a.Item,{label:"\u53d1\u884c\u5730\u533a",name:"areas",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5730\u533a"}],children:Object(r.jsx)(k.a.Group,{options:["\u4e2d\u56fd\u5927\u9646","\u7f8e\u56fd","\u65e5\u672c","\u97e9\u56fd"]})}),Object(r.jsx)(y.a.Item,{label:"\u5f71\u7247\u7c7b\u578b",name:"types",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7535\u5f71\u7c7b\u578b"}],children:Object(r.jsx)(k.a.Group,{options:["\u559c\u5267","\u60b2\u5267","\u5408\u5bb6\u6b22","\u6218\u4e89","\u79d1\u5e7b","\u60ca\u609a"]})}),Object(r.jsx)(y.a.Item,{label:"\u65f6\u957f",name:"timeLong",initialValue:120,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u65f6\u957f"}],children:Object(r.jsx)(w.a,{min:30,max:240,step:10})}),Object(r.jsx)(y.a.Item,{label:"\u6b63\u5728\u70ed\u6620",name:"isHot",valuePropName:"checked",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u5373\u5c06\u4e0a\u6620",name:"isComing",valuePropName:"checked",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u7ecf\u5178\u5f71\u7247",valuePropName:"checked",name:"isClassic",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u5f71\u7247\u63cf\u8ff0",name:"description",children:Object(r.jsx)(g.a.TextArea,{rows:4})}),Object(r.jsx)(y.a.Item,Object(m.a)(Object(m.a)({},M),{},{children:Object(r.jsx)(I.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]}))}}]),n}(c.a.Component),B=Object(p.g)(D),N=n(56),V=n.n(N),q=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"add",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("/api/movie",t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(v.a)(O.a.mark((function e(t,n){var a,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("/api/movie/".concat(t),n);case 2:return a=e.sent,r=a.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.delete("/api/movie/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getById",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("/api/movie/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.get("/api/movie/",{params:t});case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),F=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(r.jsx)(B,{onSubmit:function(){var e=Object(v.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.add(t);case 2:if(!(n=e.sent).err){e.next=5;break}return e.abrupt("return",n.err);case 5:return e.abrupt("return","");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}]),n}(c.a.Component),z=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={movie:void 0},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(v.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.props),e.next=3,q.getById(this.props.computedMatch.params.id);case 3:(t=e.sent).data&&this.setState({movie:t.data});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(r.jsx)(B,{movie:this.state.movie,onSubmit:function(){var t=Object(v.a)(O.a.mark((function t(n){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q.edit(e.props.match.params.id,n);case 2:if(!(a=t.sent).err){t.next=5;break}return t.abrupt("return",a.err);case 5:return t.abrupt("return","");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})}}]),n}(c.a.Component),T=n(542),H=n(535),R=n.p+"static/media/default.d456d3ad.jpg";!function(e){e.isHot="isHot",e.isComing="isComing",e.isClassic="isClassic"}(a||(a={}));var K=n(545),E=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.onLoad&&this.props.onLoad()}},{key:"getFilterDropdown",value:function(e){var t=this;return Object(r.jsxs)("div",{style:{padding:8},children:[Object(r.jsx)(g.a,{style:{width:188,marginBottom:8,display:"block"},value:this.props.condition.key,onChange:function(e){return t.props.onKeyChange(e.target.value)},onPressEnter:this.props.onSearch}),Object(r.jsx)(I.a,{type:"primary",icon:Object(r.jsx)(K.a,{}),size:"small",style:{width:90,marginRight:8},onClick:this.props.onSearch,children:"\u641c\u7d22"}),Object(r.jsx)(I.a,{size:"small",style:{width:90},onClick:function(){t.props.onKeyChange(""),t.props.onSearch()},children:"\u91cd\u7f6e"})]})}},{key:"getColumns",value:function(){var e=this;return[{title:"\u5c01\u9762",dataIndex:"poster",render:function(e){return e?Object(r.jsx)("img",{alt:"",className:"tablePoster",src:e}):Object(r.jsx)("img",{alt:"",className:"tablePoster",src:R})}},{title:"\u540d\u79f0",dataIndex:"name",filterDropdown:this.getFilterDropdown.bind(this),filterIcon:Object(r.jsx)(K.a,{})},{title:"\u7c7b\u578b",dataIndex:"types",render:function(e){return e.join("\uff0c")}},{title:"\u5730\u533a",dataIndex:"areas",render:function(e){return e.join("\uff0c")}},{title:"\u65f6\u957f",dataIndex:"timeLong",render:function(e){return"".concat(e,"\u5206\u949f")}},{title:"\u662f\u5426\u70ed\u6620",dataIndex:"isHot",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){e.props.onSwitchChange(a.isHot,t,n._id)}})}},{title:"\u5373\u5c06\u4e0a\u6620",dataIndex:"isComing",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){e.props.onSwitchChange(a.isComing,t,n._id)}})}},{title:"\u7ecf\u5178\u5f71\u7247",dataIndex:"isClassic",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){e.props.onSwitchChange(a.isClassic,t,n._id)}})}},{title:"\u64cd\u4f5c",dataIndex:"_id",render:function(t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(u.b,{to:"/movie/edit/".concat(t),children:Object(r.jsx)(I.a,{type:"primary",size:"small",children:"\u7f16\u8f91"})}),Object(r.jsx)(T.a,{title:"\u662f\u5426\u786e\u5b9a\u5220\u9664\u8be5\u5f71\u7247\uff1f",onConfirm:Object(v.a)(O.a.mark((function n(){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.props.onDelete(t);case 2:x.b.success("\u5220\u9664\u6210\u529f");case 3:case"end":return n.stop()}}),n)}))),okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(r.jsx)(I.a,{type:"text",size:"small",children:"\u5220\u9664"})})]})}}]}},{key:"getPageConfig",value:function(){return 0!==this.props.total&&{current:this.props.condition.page,pageSize:this.props.condition.limit,total:this.props.total}}},{key:"handleChange",value:function(e){this.props.onChange(e.current)}},{key:"render",value:function(){return Object(r.jsx)(H.a,{rowKey:"_id",dataSource:this.props.data,columns:this.getColumns(),pagination:this.getPageConfig(),onChange:this.handleChange.bind(this),loading:this.props.isLoading})}}]),n}(c.a.Component),G=n(81),U=n(121);function J(e,t){return{type:"movie_save",payload:{movies:e,total:t}}}function W(e){return{type:"movie_setLoading",payload:e}}function Q(e){return{type:"movie_setCondition",payload:e}}function X(e){return{type:"movie_delete",payload:e}}function Y(e,t,n){return{type:"movie_switch",payload:{type:e,newVal:t,id:n}}}var Z={saveMoviesAction:J,setLoadingAction:W,setConditionAction:Q,deleteAction:X,fetchMovie:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n,a){var r,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(W(!0)),n(Q(e)),r=a().movie.condition,t.next=5,q.get(r);case 5:o=t.sent,n(J(o.data,o.total)),n(W(!1));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},deleteMovie:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(W(!0)),t.next=3,q.delete(e);case 3:n(X(e)),n(W(!1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},changeSwitch:function(e,t,n){return function(){var a=Object(v.a)(O.a.mark((function a(r){return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r(W(!0)),r(Y(e,t,n)),a.next=4,q.edit(n,Object(U.a)({},e,t));case 4:r(W(!1));case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},changeSwitchAction:Y};var $=Object(G.b)((function(e){return e.movie}),(function(e){return{onLoad:function(){e(Z.fetchMovie({page:1,limit:10,key:""}))},onSwitchChange:function(t,n,a){e(Z.changeSwitch(t,n,a))},onDelete:function(t){return Object(v.a)(O.a.mark((function n(){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(Z.deleteMovie(t));case 1:case"end":return n.stop()}}),n)})))()},onChange:function(t){e(Z.fetchMovie({page:t}))},onKeyChange:function(t){e(Z.setConditionAction({key:t}))},onSearch:function(){e(Z.fetchMovie({page:1}))}}}))(E),ee=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(r.jsx)($,{})}}]),n}(c.a.Component),te=n(534),ne=n(115),ae=n(274),re=n.n(ae),oe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.props.onLoad&&this.props.onLoad()}},{key:"getFilterDropdown",value:function(e){var t=this;return Object(r.jsxs)("div",{style:{padding:8},children:[Object(r.jsx)(g.a,{style:{width:188,marginBottom:8,display:"block"},value:this.props.condition.key,onChange:function(e){return t.props.onKeyChange(e.target.value)},onPressEnter:this.props.onSearch}),Object(r.jsx)(I.a,{type:"primary",icon:Object(r.jsx)(K.a,{}),size:"small",style:{width:90,marginRight:8},onClick:this.props.onSearch,children:"\u641c\u7d22"}),Object(r.jsx)(I.a,{size:"small",style:{width:90},onClick:function(){t.props.onKeyChange(""),t.props.onSearch()},children:"\u91cd\u7f6e"})]})}},{key:"getColumns",value:function(){var e=this;return[{title:"\u5c01\u9762",dataIndex:"poster",render:function(e){return e?Object(r.jsx)("img",{src:e,alt:"",className:"tablePoster"}):Object(r.jsx)("img",{src:R,alt:"",className:"tablePoster"})}},{title:"\u540d\u79f0",dataIndex:"name",filterDropdown:this.getFilterDropdown.bind(this),filterIcon:Object(r.jsx)(K.a,{})},{title:"\u4f5c\u8005",dataIndex:"author",render:function(e){return e}},{title:"\u662f\u5426\u70ed\u6620",dataIndex:"isHot",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){console.log(t),e.props.onSwitchChange(a.isHot,t,n._id)}})}},{title:"\u5373\u5c06\u4e0a\u6620",dataIndex:"isComing",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){console.log(t),e.props.onSwitchChange(a.isComing,t,n._id)}})}},{title:"\u7ecf\u5178\u5f71\u7247",dataIndex:"isClassic",render:function(t,n){return Object(r.jsx)(C.a,{checked:t,onChange:function(t){console.log(t),e.props.onSwitchChange(a.isClassic,t,n._id)}})}},{title:"\u64cd\u4f5c",dataIndex:"_id",render:function(t){return Object(r.jsxs)("div",{children:[Object(r.jsx)(u.b,{to:"/book/edit/".concat(t),children:Object(r.jsx)(I.a,{type:"primary",size:"small",children:"\u7f16\u8f91"})}),Object(r.jsx)(T.a,{title:"\u662f\u5426\u5220\u9664\u8be5\u4e66\u76ee\uff1f",onConfirm:Object(v.a)(O.a.mark((function n(){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.props.onDelete(t);case 2:x.b.success("\u5220\u9664\u6210\u529f");case 3:case"end":return n.stop()}}),n)}))),okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(r.jsx)(I.a,{type:"text",size:"small",children:"\u5220\u9664"})})]})}}]}},{key:"getPageConfig",value:function(){return 0!==this.props.total&&{current:this.props.condition.page,pageSize:this.props.condition.limit,total:this.props.total}}},{key:"handleChange",value:function(e){this.props.onChange(e.current)}},{key:"render",value:function(){return Object(r.jsx)(re.a,{rowKey:"_id",dataSource:this.props.data,columns:this.getColumns(),pagination:this.getPageConfig(),onChange:this.handleChange.bind(this),loading:this.props.isLoading})}}]),n}(c.a.Component),ce=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"add",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("/api/book",t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(v.a)(O.a.mark((function e(t,n){var a,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("/api/book/".concat(t),n);case 2:return a=e.sent,r=a.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.delete("/api/book/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getById",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("/api/book/find/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("/api/book/find",{params:t});case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function ie(e,t){return{type:"book_save",payload:{books:e,total:t}}}function se(e){return{type:"book_setLoading",payload:e}}function ue(e){return{type:"book_setCondition",payload:e}}function pe(e){return{type:"book_delete",payload:e}}function le(e,t,n){return{type:"book_switch",payload:{type:e,newVal:t,id:n}}}var de={saveBookAction:ie,setLoadingAction:se,setConditionAction:ue,deleteAction:pe,fetchBook:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n,a){var r,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(se(!0)),n(ue(e)),r=a().book.condition,t.next=5,ce.getAll(r);case 5:o=t.sent,n(ie(o.data,o.total)),n(se(!1));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},deleteBook:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(se(!0)),t.next=3,ce.delete(e);case 3:n(pe(e)),n(se(!1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},changeSwitch:function(e,t,n){return function(){var a=Object(v.a)(O.a.mark((function a(r){return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r(se(!0)),r(le(e,t,n)),a.next=4,ce.edit(n,Object(U.a)({},e,t));case 4:r(se(!1));case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}};var je=Object(G.b)((function(e){return e.book}),(function(e){return{onLoad:function(){console.log("222"),e(de.fetchBook({page:1,limit:10,key:""}))},onSwitchChange:function(t,n,a){e(de.changeSwitch(t,n,a))},onDelete:function(t){return Object(v.a)(O.a.mark((function n(){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e(de.deleteBook(t));case 1:case"end":return n.stop()}}),n)})))()},onChange:function(t){e(de.fetchBook({page:t}))},onKeyChange:function(t){e(de.setConditionAction({key:t}))},onSearch:function(){e(de.fetchBook({page:1}))}}}))(oe),be=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(r.jsx)(je,{})}}]),n}(c.a.Component),he={labelCol:{span:5},wrapperCol:{span:19}},fe={wrapperCol:{offset:5,span:19}},Oe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=function(){var t=Object(v.a)(O.a.mark((function t(n){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,e.props.onSubmit(n);case 3:(a=t.sent)?x.b.error(a):x.b.success("\u63d0\u4ea4\u6210\u529f",1,(function(){e.props.history.push("/book")}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=[];if(this.props.book)for(var a=Object.entries(this.props.book),o=0,c=a.length;o<c;o++){var i={name:a[o][0],value:a[o][1]};n.push(i)}return Object(r.jsxs)(y.a,Object(m.a)(Object(m.a)({onFinish:t},he),{},{style:{width:"400px",padding:"1em"},fields:n,children:[Object(r.jsx)(y.a.Item,{label:"\u4e66\u76ee\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u4e66\u76ee\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(r.jsx)(g.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u5c01\u9762",name:"poster",getValueFromEvent:function(e){return e},noStyle:!0,children:Object(r.jsx)(P,{})}),Object(r.jsx)(y.a.Item,{label:"\u4e66\u76ee\u7c7b\u578b",name:"types",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e66\u76ee\u7c7b\u578b"}],children:Object(r.jsx)(k.a.Group,{options:["\u5386\u53f2","\u79d1\u5e7b","\u7eaa\u5b9e","\u4f20\u8bb0","\u5c0f\u8bf4","\u6563\u6587","\u513f\u7ae5\u8bfb\u7269"]})}),Object(r.jsx)(y.a.Item,{label:"\u6b63\u5728\u70ed\u9500",name:"isHot",valuePropName:"checked",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u5373\u5c06\u4e0a\u67b6",name:"isComing",valuePropName:"checked",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u7ecf\u5178\u4e66\u76ee",name:"isClassic",valuePropName:"checked",initialValue:!1,children:Object(r.jsx)(C.a,{})}),Object(r.jsx)(y.a.Item,{label:"\u4e66\u76ee\u63cf\u8ff0",name:"description",children:Object(r.jsx)(g.a.TextArea,{rows:4})}),Object(r.jsx)(y.a.Item,Object(m.a)(Object(m.a)({},fe),{},{children:Object(r.jsx)(I.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]}))}}]),n}(c.a.Component),ve=Object(p.g)(Oe),me=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={book:void 0},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(v.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce.getById(this.props.computedMatch.params.id);case 2:(t=e.sent).data&&this.setState({book:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(r.jsx)(ve,{book:this.state.book,onSubmit:function(){var t=Object(v.a)(O.a.mark((function t(n){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ce.edit(e.props.match.params.id,n);case 2:if(!(a=t.sent).err){t.next=5;break}return t.abrupt("return",a.err);case 5:return t.abrupt("return","");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})}}]),n}(c.a.Component),xe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(r.jsx)(ve,{onSubmit:function(){var e=Object(v.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce.add(t);case 2:if(!(n=e.sent).err){e.next=5;break}return e.abrupt("return",n.err);case 5:return e.abrupt("return","");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}]),n}(c.a.Component),ye=n(284);var ge=Object(G.b)((function(e){return e.user}))((function(e){var t=e.component,n=(e.children,e.render,Object(ye.a)(e,["component","children","render"]));return Object(r.jsx)(p.b,Object(m.a)(Object(m.a)({},n),{},{render:function(e){var a=e.location.pathname;return n.isLogin?Object(r.jsx)(t,Object(m.a)({},n)):Object(r.jsx)(p.a,{to:{pathname:"/login",state:a}})}}))})),ke=n(546),we=n(547),Ce=n(548),Ie=n(543),Se={labelCol:{span:5},wrapperCol:{span:19}},_e={wrapperCol:{offset:5,span:19}},Le=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=function(){var t=Object(v.a)(O.a.mark((function t(n){var a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,e.props.onSubmit(n);case 3:(a=t.sent)?x.b.error(a):x.b.success("\u63d0\u4ea4\u6210\u529f",1,(function(){e.props.location.state?e.props.history.push(e.props.location.state):e.props.history.push("/")}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(r.jsxs)(y.a,Object(m.a)(Object(m.a)({onFinish:t},Se),{},{style:{width:"400px",padding:"1em"},children:[Object(r.jsx)(y.a.Item,{label:"\u7528\u6237",name:"loginId",rules:[{required:!0,message:"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(r.jsx)(g.a,{placeholder:"default size",prefix:Object(r.jsx)(ke.a,{})})}),Object(r.jsx)(y.a.Item,{label:"\u5bc6\u7801",name:"loginPwd",rules:[{required:!0,message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(r.jsx)(Ie.b,{direction:"vertical",children:Object(r.jsx)(g.a.Password,{placeholder:"input password",iconRender:function(e){return e?Object(r.jsx)(we.a,{}):Object(r.jsx)(Ce.a,{})}})})}),Object(r.jsx)(y.a.Item,Object(m.a)(Object(m.a)({},_e),{},{children:Object(r.jsx)(I.a,{type:"primary",htmlType:"submit",children:"\u767b\u5f55"})}))]}))}}]),n}(c.a.Component),Pe=Object(p.g)(Le),Ae=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"add",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("/api/user/add",t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(v.a)(O.a.mark((function e(t,n){var a,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.post("/api/user/login",{loginId:t,loginPwd:n});case 2:return a=e.sent,r=a.data,console.log(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"whoami",value:function(){var e=Object(v.a)(O.a.mark((function e(t){var n,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.put("api/user/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Me(e){return{type:"user_save",payload:{user:e}}}function De(e){return{type:"user_setLoading",payload:e}}var Be={setConditionAction:function(e){return{type:"user_setCondition",payload:e}},setLoadingAction:De,saveUserAction:Me,registerAction:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n,a){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(De(!0)),t.next=3,Ae.add(e);case 3:(r=t.sent).data&&n(Me(r.data)),n(De(!1));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},loginAction:function(e,t){return function(){var n=Object(v.a)(O.a.mark((function n(a,r){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("111"),a(De(!0)),n.next=4,Ae.login(e,t);case 4:n.sent.data&&a({type:"user_setLogin",payload:!0}),a(De(!1));case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},whoamiAction:function(e){return function(){var t=Object(v.a)(O.a.mark((function t(n,a){var r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(De(!0)),t.next=3,Ae.whoami(e);case 3:(r=t.sent).data&&n(Me(r.data)),n(De(!1));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}};var Ne=Object(G.b)((function(e){return e.user}),(function(e,t){return{onSubmit:function(t){return Object(v.a)(O.a.mark((function n(){return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e(Be.loginAction(t.loginId,t.loginPwd));case 2:return n.abrupt("return",null);case 3:case"end":return n.stop()}}),n)})))()}}}))(Pe),Ve=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props;return Object(r.jsx)(Ne,{pushState:e})}}]),n}(c.a.Component),qe=te.a.Header,Fe=te.a.Sider,ze=te.a.Content,Te=function(){return Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)(te.a,{children:[Object(r.jsx)(qe,{className:"header",children:Object(r.jsx)(u.b,{to:"/",children:"\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf"})}),Object(r.jsxs)(te.a,{children:[Object(r.jsx)(Fe,{children:Object(r.jsxs)(ne.a,{mode:"inline",theme:"dark",children:[Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/",children:"\u9996\u9875"})},"1"),Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/movie",children:"\u7535\u5f71\u5217\u8868"})},"2"),Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/movie/add",children:"\u6dfb\u52a0\u7535\u5f71"})},"3"),Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/book",children:"\u4e66\u76ee\u5217\u8868"})},"4"),Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/book/add",children:"\u6dfb\u52a0\u4e66\u76ee"})},"5"),Object(r.jsx)(ne.a.Item,{children:Object(r.jsx)(u.b,{to:"/login",children:"\u767b\u5f55\u6ce8\u9500"})},"6")]})}),Object(r.jsx)(ze,{children:Object(r.jsx)("div",{className:"main",children:Object(r.jsxs)(p.d,{children:[Object(r.jsx)(p.b,{path:"/login",component:Ve}),Object(r.jsx)(ge,{path:"/movie",component:ee,exact:!0}),Object(r.jsx)(ge,{path:"/movie/add",component:F}),Object(r.jsx)(ge,{path:"/movie/edit/:id",component:z}),Object(r.jsx)(ge,{path:"/book",component:be,exact:!0}),Object(r.jsx)(ge,{path:"/book/add",component:xe}),Object(r.jsx)(ge,{path:"/book/edit/:id",component:me}),Object(r.jsx)(p.b,{path:"/",component:h,exact:!0})]})})})]})]})})},He=n(99),Re={data:[],condition:{page:1,limit:10,key:""},total:0,isLoading:!1,totalPage:0},Ke=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{data:t.payload.books,total:t.payload.total,totalPage:Math.ceil(t.payload.total/e.condition.limit)})},Ee=function(e,t){var n=Object(m.a)(Object(m.a)({},e),{},{condition:Object(m.a)(Object(m.a)({},e.condition),t.payload)});return n.totalPage=Math.ceil(n.total/n.condition.limit),n},Ge=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{isLoading:t.payload})},Ue=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{data:e.data.filter((function(e){return e._id!==t.payload})),total:e.total-1,totalPage:Math.ceil((e.total-1)/e.condition.limit)})},Je=function(e,t){var n=e.data.find((function(e){return e._id===t.payload.id}));if(!n)return e;var a=Object(m.a)({},n);a[t.payload.type]=t.payload.newVal;var r=e.data.map((function(e){return e._id===t.payload.id?a:e}));return Object(m.a)(Object(m.a)({},e),{},{data:r})},We={data:[],condition:{page:1,limit:10,key:""},total:0,isLoading:!1,totalPage:0},Qe=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{data:t.payload.movies,total:t.payload.total,totalPage:Math.ceil(t.payload.total/e.condition.limit)})},Xe=function(e,t){var n=Object(m.a)(Object(m.a)({},e),{},{condition:Object(m.a)(Object(m.a)({},e.condition),t.payload)});return n.totalPage=Math.ceil(n.total/n.condition.limit),n},Ye=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{isLoading:t.payload})},Ze=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{data:e.data.filter((function(e){return e._id!==t.payload})),total:e.total-1,totalPage:Math.ceil((e.total-1)/e.condition.limit)})},$e=function(e,t){var n=e.data.find((function(e){return e._id===t.payload.id}));if(!n)return e;var a=Object(m.a)({},n);a[t.payload.type]=t.payload.newVal;var r=e.data.map((function(e){return e._id===t.payload.id?a:e}));return Object(m.a)(Object(m.a)({},e),{},{data:r})},et={data:{loginId:"",loginPwd:""},condition:{loginId:"",loginPwd:""},isLoading:!1,isLogin:!1},tt=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{data:t.payload.user})},nt=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{condition:Object(m.a)(Object(m.a)({},e.condition),t.payload)})},at=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{isLoading:t.payload})},rt=function(e,t){return Object(m.a)(Object(m.a)({},e),{},{isLogin:t.payload})},ot=Object(He.combineReducers)({movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"movie_delete":return Ze(e,t);case"movie_save":return Qe(e,t);case"movie_setCondition":return Xe(e,t);case"movie_setLoading":return Ye(e,t);case"movie_switch":return $e(e,t);default:return e}},book:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"book_delete":return Ue(e,t);case"book_save":return Ke(e,t);case"book_setCondition":return Ee(e,t);case"book_setLoading":return Ge(e,t);case"book_switch":return Je(e,t);default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user_save":return tt(e,t);case"user_setCondition":return nt(e,t);case"user_setLoading":return at(e,t);case"user_setLogin":return rt(e,t);default:return e}}}),ct=n(275),it=n.n(ct),st=n(276),ut=n(277),pt=Object(He.createStore)(ot,Object(ut.composeWithDevTools)(Object(He.applyMiddleware)(st.a,it.a))),lt=function(){return Object(r.jsx)(G.a,{store:pt,children:Object(r.jsx)(u.a,{children:Object(r.jsx)(p.b,{path:"/",component:Te})})})};n(531);s.a.render(Object(r.jsx)(lt,{}),document.getElementById("root"))}},[[532,1,2]]]);
//# sourceMappingURL=main.a1df218c.chunk.js.map